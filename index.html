<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cyberpunk Shooter</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

<style>
body {
    margin: 0;
    background: black;
    overflow: hidden;
}
canvas {
    display: block;
}
</style>
</head>
<body>

<canvas id="game"></canvas>

<script>
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("sw.js");
}

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let player = {
    x: canvas.width / 2 - 20,
    y: canvas.height - 80,
    width: 40,
    height: 40,
    speed: 6
};

let bullets = [];
let enemies = [];
let score = 0;

function spawnEnemy() {
    enemies.push({
        x: Math.random() * (canvas.width - 40),
        y: -40,
        width: 40,
        height: 40,
        speed: 2 + Math.random() * 2
    });
}

function shoot() {
    bullets.push({
        x: player.x + 17,
        y: player.y,
        width: 6,
        height: 15,
        speed: 8
    });
}

function detectCollision(a, b) {
    return (
        a.x < b.x + b.width &&
        a.x + a.width > b.x &&
        a.y < b.y + b.height &&
        a.y + a.height > b.y
    );
}

function update() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    ctx.fillStyle = "#00ffff";
    ctx.fillRect(player.x, player.y, player.width, player.height);

    ctx.fillStyle = "#ff00ff";
    bullets.forEach((b, bi) => {
        b.y -= b.speed;
        ctx.fillRect(b.x, b.y, b.width, b.height);
        if (b.y < 0) bullets.splice(bi, 1);
    });

    ctx.fillStyle = "red";
    enemies.forEach((e, ei) => {
        e.y += e.speed;
        ctx.fillRect(e.x, e.y, e.width, e.height);

        bullets.forEach((b, bi) => {
            if (detectCollision(b, e)) {
                enemies.splice(ei, 1);
                bullets.splice(bi, 1);
                score++;
            }
        });
    });

    ctx.fillStyle = "cyan";
    ctx.fillText("Score: " + score, 20, 30);

    requestAnimationFrame(update);
}

document.addEventListener("touchstart", shoot);
setInterval(spawnEnemy, 1000);
update();
</script>

</body>{
  "name": "Cyberpunk Shooter",
  "short_name": "Cyberpunk",
  "start_url": "index.html",
  "display": "standalone",
  "background_color": "#000000",
  "theme_color": "#000000",
  "icons": [
    {
      "src": "icon.png",
      "sizes": "192x192",
      "type": "image/png"
    }
  ]
}self.addEventListener("install", event => {
  event.waitUntil(
    caches.open("cyberpunk-cache").then(cache => {
      return cache.addAll(["index.html"]);
    })
  );
});

self.addEventListener("fetch", event => {
  event.respondWith(
    caches.match(event.request).then(response => {
      return response || fetch(event.request);
    })
  );
});